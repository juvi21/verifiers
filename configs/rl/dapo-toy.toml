model = "Qwen/Qwen2.5-1.5B-Instruct"

[env]
id = "tool-test"

[inference]
gpus = 1

[inference.args]
enforce_eager = true

[trainer]
gpus = 1

[trainer.args]
run_name = "dapo-toy"
rl_algo = "dapo"
micro_batch_size = 8
batch_size = 128
max_steps = 20
max_seq_len = 1024
mask_env_responses = true
mask_truncated_completions = true
zero_truncated_completions = true
bf16 = false

[trainer.dapo]
group_size = 4
eps_low = 0.2
eps_high = 0.3
max_length = 512
length_cache = 50
learning_rate = 1e-5
max_grad_norm = 1.0
dynamic_sampling = true
variance_threshold = 0.01
skip_ratio_threshold = 0.5
reinclude_fraction = 0.2
normalize_advantages = true
length_penalty_enabled = true
length_penalty_target = 512
length_penalty_max = 0.5
truncation_penalty = 0.2
